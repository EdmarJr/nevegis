<html>
<head>
	<title>Exemplo - com JQuery e JQueryUI</title>
	<link href="http://code.jquery.com/ui/1.9.2/themes/base/jquery-ui.css" type="text/css" rel="stylesheet"/>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js" type="text/javascript"></script>
	<script src="http://code.jquery.com/ui/1.9.2/jquery-ui.js" type="text/javascript"></script>
	<script src="ICPBravoAPIMini-1.33.js" type="text/javascript"></script>
	<script type="text/javascript">

		var toSign = "SGVsbG8sIFdvcmxkIQ==";
	
		$(function() {
			$("#assinarButton").click(onAssinarButtonClick);
		});

		function onAppletLoaded() {
			icpBravoApplet.setFilterICPBrasil(true);
			var certs = icpBravoApplet.loadCertificates();
			$.each(certs, adicionaCertificado);
		}
		
		function adicionaCertificado(alias, name) {
			$('#certificateSelect').append("<option value='" + alias + "'>" + name + "</option>");
		}
		
		function onAssinarButtonClick() {
	        var selectedCert = $("#certificateSelect").val();
	        var cert = icpBravoApplet.getCertificateProperties(selectedCert);
	        var signature = icpBravoApplet.signSimpleBytes(selectedCert, toSign);
			alert("Certificate:\r\n" + cert);
			alert("Signature:\r\n" + signature);
		}
	</script>
</head>
<body>
<select id='certificateSelect'></select>
<input type="button" value="Assinar" id="assinarButton" />
<script type="text/javascript">
	icpBravoApplet.start({
		appletUrl: 'ICPBravoAPIMini-1.33.jar',
		onLoad: onAppletLoaded
	});
</script>
</body>
</html>